//<br>&emsp;&emsp;&emsp;
markers.beaver1 = createMarker({ lat:43.6727,lng:-79.4091}, 'beaver','加拿大多倫多',{ A:['beaver'], B:['清'],C:['身份象徵'],D:['其他'],E:['北美洲'] }
   ,{  title_cn: '描述',title_en: 'Description'
       ,description_cn: '河狸，又名海狸，是北美洲的原生動物之一。哥倫布發現新大陸後，歐洲國家紛紛前往美洲建立殖民地。17世紀，荷蘭殖民者在美國東北部建立了新尼德蘭，其範圍大致包括如今的紐約州、康涅狄格州和新澤西州。荷蘭商人在北美五大湖區大量獵殺河狸以獲取皮毛，再銷售至歐洲。在荷蘭畫家維梅爾的作品《軍官和面帶微笑的少女》中，軍官頭頂的氈帽就是以河狸皮為原料製作的。'
       ,description_en: 'Beavers are one of the native animals of North America. Following Columbus\' discovery of the New World, European countries started establishing colonies in the Americas. In the 17th century, Dutch colonists established New Netherland in the northeastern United States, which covered approximately the present-day States of New York, Connecticut, and New Jersey. Dutch traders hunted beavers in the Great Lakes region for the furs and sold them in Europe. In the painting "Officer and Laughing Girl" by the Dutch painter Johannes Vermeer, the hat on the officer\'s head was made from beaver hides.'
	   ,reference:'1. Timothy Brook,Vermeer\'s Hat: The Seventeenth Century and the Dawn of the Global World (New York and London: Bloomsbury Press, 2008), pp. 29-46.<br>&emsp;&emsp;&emsp;2. Officer and Laughing Girl, The Frick Collection, collections.frick.org/objects/275/officer-and-laughing-girl.'
       ,image:'media/OneDrive_1_2024-1-8/472.(1657, Officer and Laughing Girl, housed in The Frick Madison).jpg'
       ,image_content_cn:'公元1657年，軍官和面帶微笑的少女，弗里克收藏館藏'
       ,image_content_en:'1657, Officer and Laughing Girl, housed in The Frick Collection'
   ,referenceUrl:''
    });			
//美國紐約，荷蘭代夫特	--

markers.beaver2 = createMarker({ lat:30.0012,lng:-90.0464}, 'beaver','美國新奧爾良',{ A:['beaver'], B:['清'],C:['身份象徵'],D:['其他'],E:['北美洲'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'17世紀，法國人在魁北克建立了第一個殖民定居點。此後，聖勞倫斯河流域和密西西比河流域都被納入法國殖民地的勢力範圍，即新法蘭西。法國殖民者與北美洲的印第安人合作大量獵殺動物以獲取皮毛，尤其是河狸皮。在法國國王路易十四的支持下，北美洲和歐洲之間的皮毛貿易成為新法蘭西的支柱產業。'  
	,description_en:'In the 17th century, the French established the first colonial settlement in Quebec. Afterwards, the St. Lawrence River Valley and the Mississippi River Valley were included in the French colonies, namely the New France. French colonists, in co-operation with the Indians of North America, hunted large numbers of animals for their fur, especially the beaver furs. Under the support of the Louis XIV, the King of France, the fur trade between North America and Europe became the pillar industry of New France.'
	,reference:'1. 付成雙，《動物改變世界：海狸、毛皮貿易與北美開發》（北京：北京大學出版社，2016年），頁35-42，63-72。<br>&emsp;&emsp;&emsp;2. 杜君立，〈毛皮征服歷史〉，《天涯》，期6（2018年11月），頁30-31。'  
	,image:''
	,referenceUrl:''
    });
//加拿大魁北克，加拿大聖皮埃爾港，法國勒阿弗爾	---
       
markers.beaver3 = createMarker({ lat:44.9744,lng:-93.2701}, 'beaver','美國明尼阿波利斯',{ A:['beaver'], B:['清'],C:['身份象徵'],D:['其他'],E:['北美洲']},
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'17世紀，和其他歐洲國家一樣，英國殖民者也在美洲開闢了殖民地。至18世紀初期，英國通過戰爭先後擊敗了荷蘭和法國，幾乎搶奪了他們在北美的全部殖民地。此後，英國壟斷了北美洲和歐洲之間的皮毛貿易。在皮毛貿易的鼎盛時期，每年有上百萬美洲河狸被獵殺。 murgh｣（意為｢駱駝鳥｣），這一詞彙被直接翻譯成了中文，取代了原本的｢大雀｣等詞彙。在北魏的歷史記載中，薩珊王朝的鴕鳥甚至衍生出了可以食用火焰、鋼鐵等傳說。'  
	,description_en:'In the 17th century, like other European countries, the British colonists opened up colonies in the Americas. At the beginning of the 18th century, Britain defeated Holland and France in wars and captured almost all their colonies in North America. Afterward, Britain monopolized the fur trade between North America and Europe. At the height of the fur trade, over a million American beavers were killed every year.'
	 ,reference:'1. 付成雙，《動物改變世界：海狸、毛皮貿易與北美開發》（北京：北京大學出版社，2016年），頁77-85，92-94，122-125。<br>&emsp;&emsp;&emsp;2. 杜君立，〈毛皮征服歷史〉，《天涯》，期6（2018年11月），頁29-32。'  
	,image:''
	,referenceUrl:''});
//美國普利茅斯，英國普利茅斯，英國倫敦	---
   
markers.beaver4 = createMarker({lat:42.3321,lng:-83.0648}, 'beaver','美國底特律',{ A:['beaver'], B:['清'],C:['身份象徵'],D:['海上絲綢之路'],E:['北美洲'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'美國獨立後，皮毛成為美國向中國輸出的主要貿易商品。1785年，紐約和廣州之間的貿易航線開通。至19世紀初期，中美間的皮毛貿易達到頂峰，每年有數萬張河狸皮運輸至廣州。'  
	,description_en:'After the independence of the United States, fur became the major commodity exported from the U.S. to China. In 1785, the trade route between New York and Guangzhou 廣州 was opened. By the early 19th century, the fur trade between the United States and China was at its peak, with tens of thousands of beaver hides transported to Guangzhou each year.'
	 ,reference:'1. 郭衛東，〈毛皮：清代北美對華貿易的重要貨品〉，《安徽史學》，期6（2015年12月），頁24-27。<br>&emsp;&emsp;&emsp;2. 付成雙，《動物改變世界：海狸、毛皮貿易與北美開發》（北京：北京大學出版社，2016年），頁234-240。'  
	,image:''
	,referenceUrl:''});
//美國紐約，佛得角，南非開普敦，印度尼西亞巽他海峽，中國澳門，廣東廣州	------


   
// 获取时间轴元素和标记
var timeline = document.getElementById('timeline');
var slider = document.getElementById('slider');
var beavers = [
    'beaver1', 'beaver2', 'beaver3', 'beaver4'
];

for (var i = 0; i < beavers.length; i++) {
    window[beavers[i]] = markers[beavers[i]];
}



// 定义新坐标和初始坐标

// 定义一个函数，生成指定范围内的随机数
function getRandomNumber(min, max) {
    return Math.random() * (max - min) + min;
}

// 定义一个函数，生成新的坐标对象，并添加随机数
function RandomCoords(coords) {
    var randomLat = coords.lat + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
    var randomLng = coords.lng + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
    return { lat: randomLat, lng: randomLng };
}

var newCoords_beaver1_1= {lat:40.7082676,lng:-74.0203};
var newCoords_beaver1_2= {lat:52.0113281,lng:4.3555};

var newCoords_beaver2_1= {lat:46.8150387,lng:-71.2583};
var newCoords_beaver2_2= {lat:50.2418267,lng:-63.6088};
var newCoords_beaver2_3= {lat:49.492585,lng:0.1037};

var newCoords_beaver3_1= {lat:41.9590782,lng:-70.6738};
var newCoords_beaver3_2= {lat:50.3760095,lng:-4.1560};
var newCoords_beaver3_3= {lat:51.5043409,lng:-0.1411};

var newCoords_beaver4_1= {lat:40.7097467,lng:-74.0319};
var newCoords_beaver4_2= {lat:16.5081967,lng:-24.2041};
var newCoords_beaver4_3= {lat:-33.9145576,lng:18.3954};
var newCoords_beaver4_4= {lat:-5.9205345,lng:105.8755};
var newCoords_beaver4_5= {lat:22.1957963,lng:113.5415};
var newCoords_beaver4_6= {lat:23.1256874,lng:113.2677};


var luoyang= {lat:34.6321,lng:112.4470}//洛阳
var kaifeng ={lat:34.7872,lng:114.3081};//开封
var beijing ={lat:39.9171,lng:116.3797};//北京
var xian= {lat:34.2655,lng:108.9508};//西安



//河西走廊:敦煌-酒泉-张掖-武威
var dunhuang= { lat:	40.1130	,lng:94.6618 }; 
var wuwei = {lat:37.9283,lng:102.6371};
var jiuquan={lat:39.7237,lng:98.3444}
var zhangye = {lat:38.9177,lng:100.3065};
//海上絲路：古里-xilan-palk-馬六甲
var guli ={lat:11.2618,lng:75.7822};
var xilan={lat:6.9397,lng:79.8259};
var palk={lat:10.0803,lng:80.1207};
var maliujia={lat:2.2373,lng:102.1691};
var kailuo={lat:	30.0444 ,lng:31.2357};
var kemolin={lat:8.0864,lng:77.5355};
var jibudi={lat:11.8125,lng:41.9678};
var taihai={lat:24.2877,lng:119.5445};
var zhangjiagang={lat:31.8774,lng:120.4609};
var nanhai={lat:-0.3778,lng:106.0436};


function getInitialCoords(beaver) {
    const position = beaver.getPosition();
    return {
        lat: position.lat(),
        lng: position.lng()
    };
}
var initialCoords_beaver1 = getInitialCoords(beaver1);
var initialCoords_beaver2 = getInitialCoords(beaver2);
var initialCoords_beaver3 = getInitialCoords(beaver3);
var initialCoords_beaver4 = getInitialCoords(beaver4);



// 添加滑块值变化的事件监听器
slider.addEventListener('input', function() {
    
    handleToggleMarkers(currentValue)
   
    //史前之前
    if (currentValue<=0)
    {
        markers.beaver1.setPosition(initialCoords_beaver1);
        markers.beaver2.setPosition(initialCoords_beaver2);
        markers.beaver3.setPosition(initialCoords_beaver3);
        markers.beaver4.setPosition(initialCoords_beaver4);
     
    }
    //史前
    if(currentValue>0&&currentValue<1000)
    {
       
     
    }
    //秦汉
    if (currentValue >= 1000 && currentValue < 2000) {
        
    }
    //三国
    if (currentValue >= 2000 && currentValue <3000) {
       
       
        
    }
    //隋
    if(currentValue>=3000&&currentValue<4000){
        

          
        
    }
    //唐
    if (currentValue >= 4000 && currentValue < 5000) {

    }
    //宋
    if (currentValue >= 5000 && currentValue <6000) {
        

        

    }
    //元
    if (currentValue >= 6000 && currentValue <7000) {
       
  
       
    
    }
   //明
   if(currentValue >=7000 && currentValue <8000){
      
      
    }

    //清
    if(currentValue >=8000 && currentValue <=9000){
       
          
        var points_1 = [initialCoords_beaver1,  newCoords_beaver1_1, newCoords_beaver1_2,newCoords_beaver1_2];
        var points_2 = [initialCoords_beaver2,  newCoords_beaver2_1, newCoords_beaver2_2,newCoords_beaver2_3,newCoords_beaver2_3];
        var points_3 = [initialCoords_beaver3,  newCoords_beaver3_1, newCoords_beaver3_2,newCoords_beaver3_3,newCoords_beaver3_3];
        var points_4 = [initialCoords_beaver4,  newCoords_beaver4_1, newCoords_beaver4_2,newCoords_beaver4_3,newCoords_beaver4_4,newCoords_beaver4_5,newCoords_beaver4_6,newCoords_beaver4_6];

    // 计算当前阶段的目标点的索引
        
        var targetIndex_1 = Math.floor((currentValue - 8000) / (1000 / (points_1.length-1)));
        var targetIndex_2 = Math.floor((currentValue - 8000) / (1000 / (points_2.length-1)));
        var targetIndex_3 = Math.floor((currentValue - 8000) / (1000 / (points_3.length-1)));
        var targetIndex_4 = Math.floor((currentValue - 8000) / (1000 / (points_4.length-1)));


    // 计算插值百分比
        
        var percentage_1 = (currentValue - 8000) % (1000 / (points_1.length-1)) / (1000 / (points_1.length-1));
        var percentage_2 = (currentValue - 8000) % (1000 / (points_2.length-1)) / (1000 / (points_2.length-1));
        var percentage_3 = (currentValue - 8000) % (1000 / (points_3.length-1)) / (1000 / (points_3.length-1));
        var percentage_4 = (currentValue - 8000) % (1000 / (points_4.length-1)) / (1000 / (points_4.length-1));


       
        percentage_1 = Math.min(1, Math.max(0, percentage_1));
        percentage_2 = Math.min(1, Math.max(0, percentage_2));
        percentage_3 = Math.min(1, Math.max(0, percentage_3));
        percentage_4 = Math.min(1, Math.max(0, percentage_4));


    // 计算插值的新位置

        var latDiff = points_1[targetIndex_1 + 1].lat - points_1[targetIndex_1].lat;
        var lngDiff = points_1[targetIndex_1 + 1].lng - points_1[targetIndex_1].lng;
        var interpolatedLat_1 = points_1[targetIndex_1].lat + latDiff * percentage_1
        var interpolatedLng_1 = points_1[targetIndex_1].lng + lngDiff * percentage_1

        var latDiff = points_2[targetIndex_2 + 1].lat - points_2[targetIndex_2].lat;
        var lngDiff = points_2[targetIndex_2 + 1].lng - points_2[targetIndex_2].lng;
        var interpolatedLat_2 = points_2[targetIndex_2].lat + latDiff * percentage_2
        var interpolatedLng_2 = points_2[targetIndex_2].lng + lngDiff * percentage_2

        
        var latDiff = points_3[targetIndex_3 + 1].lat - points_3[targetIndex_3].lat;
        var lngDiff = points_3[targetIndex_3 + 1].lng - points_3[targetIndex_3].lng;
        var interpolatedLat_3 = points_3[targetIndex_3].lat + latDiff * percentage_3
        var interpolatedLng_3 = points_3[targetIndex_3].lng + lngDiff * percentage_3

        var latDiff = points_4[targetIndex_4 + 1].lat - points_4[targetIndex_4].lat;
        var lngDiff = points_4[targetIndex_4 + 1].lng - points_4[targetIndex_4].lng;
        var interpolatedLat_4 = points_4[targetIndex_4].lat + latDiff * percentage_4
        var interpolatedLng_4 = points_4[targetIndex_4].lng + lngDiff * percentage_4
    
        

        
        beaver1.setPosition({ lat: interpolatedLat_1, lng: interpolatedLng_1 });
        beaver2.setPosition({ lat: interpolatedLat_2, lng: interpolatedLng_2 });     
        beaver3.setPosition({ lat: interpolatedLat_3, lng: interpolatedLng_3 });
        beaver4.setPosition({ lat: interpolatedLat_4, lng: interpolatedLng_4 });
       
        
    }
    
    
});










