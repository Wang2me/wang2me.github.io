//<br>&emsp;&emsp;&emsp;
markers.giraffe1 = createMarker({ lat:32.0650,lng:118.7939}, 'giraffe','江蘇南京',{ A:['giraffe'], B:['明'],C:['身份象徵'],D:['海上絲綢之路'],E:['東亞'] }
   ,{  title_cn: '描述',title_en: 'Description'
       ,description_cn: '麒麟原本是中國古代傳說中的一種動物。鄭和下西洋引入了長頸鹿後，明朝人認為長頸鹿就是麒麟。有歷史學家統計過，明朝時一共有八次引入長頸鹿的記錄。在明朝，長頸鹿有著非常重要的政治意義。只有高級貴族或錦衣衛高級官員才被獲准使用長頸鹿圖案的官服補子。'
       ,description_en: 'The qilin 麒麟 was a legendary animal from ancient Chinese mythology. In the Ming Dynasty 明朝, the giraffe was believed to be the qilin, after it was introduced during Zheng He\'s 鄭和 voyages. According to the statistics of some historians, there were a total of eight giraffe introductions during the Ming Dynasty. The giraffe had an important significance in the political occasions of the Ming Dynasty. The giraffe-patterned official mandarin squares were allowed only for high-ranking nobles or high-ranking officials of the Jinyiwei 錦衣衛 (Embroidered Uniform Guard).'
	   ,reference:'1. 王光堯，〈永樂皇帝的麒麟——海外考古調查札記（四）〉，《故宮博物院院刊》，總期231（2021年7月），頁105。<br>&emsp;&emsp;&emsp;2. 沈德符，《萬曆野獲編·補遺三》（北京：中華書局據清道光七年姚氏扶荔山房刻本勘校，1959），頁870。<br>&emsp;&emsp;&emsp;3. 袁俊卿、阮國林，〈明徐達五世孫徐俌夫婦墓〉，《文物》，期2（1982年2月），頁30。'
       ,imag:''
       ,referenceUrl:''
    });			
    
markers.giraffe2 = createMarker({ lat:22.5652,lng:88.3522}, 'giraffe','印度加爾各答',{ A:['giraffe'], B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['南亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'榜葛剌位於如今的孟加拉國以及印度東部地區。榜葛剌曾經兩次向明朝進貢長頸鹿。在台北故宮博物院收藏有一幅名為《名人畫麒麟沈度頌》的繪畫，其內容是永樂十二年（公元1414年）榜葛剌使者進貢的長頸鹿。研究人員認為，這幅畫應該是由明朝宮廷畫師繪製並賞賜給大臣的，有政治宣傳的意義。'  
	,description_en:'Bengal was located in the present-day Bangladesh and the eastern part of India. The giraffes were contributed by Bengal to the Ming Dynasty 明朝 on two occasions. The "Kylin with an Ode with Shen Du", a painting housed in the National Palace Museum in Taipei, represents the giraffe as tribute from Bengal in 1414. Researchers believe that this painting was created by the court painters, and awarded to the minister for political publicity.'
	,reference:'1. 張廷玉等，《明史·列傳第二百十四》（北京：中華書局，1997），頁8446。<br>&emsp;&emsp;&emsp;2. 四方來朝：職貢圖特展，國立故宮博物院，theme.npm.edu.tw/exh109/FourQuarters/ch/page-2.html#main。'  
	,image:'media/OneDrive_1_2024-1-8/391. (Ming Dynasty, Kylin with an Ode with Shen Du, housed in National Palace Museum).jpg'
	,image_content_cn:'明，明人畫麒麟沈度頌，國立故宮博物院藏'
	,image_content_en:'Ming Dynasty, Kylin with an Ode with Shen Du, housed in National Palace Museum'
   ,referenceUrl:''
    });
   
markers.giraffe3 = createMarker({ lat:27.1356,lng:57.0539}, 'giraffe','伊朗米納卜',{ A:['giraffe'], B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['西亞']},
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'忽魯謨斯，即如今伊朗米納卜，地處霍爾木茲海峽，是進入波斯灣的必經之路。鄭和的船隊曾多次到達此處。1414年，忽魯謨斯國王跟隨鄭和的船隊返回北京，向永樂皇帝進貢馬匹。此外，獅子和長頸鹿也是忽魯謨斯經常攜帶的貢品。'  
	,description_en:'Hormuz, the present-day Minab in Iran, was located on the essential route into the Persian Gulf. Zheng He 鄭和 visited this place on several occasions. In 1414, the King of Hormuz visited Beijing 北京 with Zheng He and offered horses to Yongle Emperor 永樂皇帝 as tribute. In addition, lions and giraffes were often the tributes from Hormuz.'
	 ,reference:'1. 張廷玉等，《明史·列傳第二百十四》（北京：中華書局，1997），頁8452。<br>&emsp;&emsp;&emsp;2. 馬歡，《瀛涯勝覽》（北京：中華書局據寶顏堂秘笈本影印，1985），頁85-86。'  
	,image:''
	,referenceUrl:''});
    
markers.giraffe4 = createMarker({ lat:12.7917,lng:44.9990}, 'giraffe','也門亞丁',{ A:['giraffe'], B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['西亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'亞丁在明代被稱為阿丹。據史書記載，阿丹國王十分崇敬中國，用大量珍寶與鄭和進行貿易。鄭和船隊從阿丹帶回了長頸鹿、獅子、豹、花貓、鴕鳥等動物。'  
	,description_en:'The king of Aden greatly respected the Ming Dynasty 明朝 and traded with Zheng He 鄭和 for a large number of treasures. Zheng He\'s fleet brought back giraffes, lions, leopards, spotted cats, ostriches and other animals from Aden.'
	 ,reference:'1. 馬歡，《瀛涯勝覽》（北京：中華書局據寶顏堂秘笈本影印，1985），頁71。'  
	,image:''
	,referenceUrl:''});

markers.giraffe5 = createMarker({ lat:21.4142,lng:39.7987 }, 'giraffe','沙特阿拉伯麥加',{ A:['giraffe'], B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['西亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'麥加是伊斯蘭教的發祥地，在明朝時被稱為天方。鄭和曾經派遣七名使者到達天方，帶回了長頸鹿、獅子、鴕鳥等動物。'  
	,description_en:'Mecca is the birthplace of Islam. Zheng He 鄭和 once sent seven envoys to Mecca, bringing back giraffes, lions, ostriches and other animals.'
	,reference:'1. 馬歡，《瀛涯勝覽》（北京：中華書局據寶顏堂秘笈本影印，1985），頁90-91。'  
	,image:''
	,referenceUrl:''});

markers.giraffe6 = createMarker({ lat:-3.2197,lng:40.1148 }, 'giraffe','肯尼亞馬林迪',{ A:['giraffe'],B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['非洲'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'麻林，即如今肯尼亞的馬林迪。永樂十三年（公元1415年），麻林向明朝進貢長頸鹿。'  
	,description_en:'In 1415, the Malindi of Kenya presented a giraffe to the Ming Dynasty 明朝 as tribute.'
	 ,reference:'1. 張廷玉等，《明史·列傳第二百十四》（北京：中華書局，1997），頁8451-8452。'  
	,image:''
	,referenceUrl:''});



    
// 获取时间轴元素和标记
var timeline = document.getElementById('timeline');
var slider = document.getElementById('slider');
var giraffes = [
    'giraffe1', 'giraffe2', 'giraffe3', 'giraffe4', 'giraffe5', 'giraffe6'
];

for (var i = 0; i < giraffes.length; i++) {
    window[giraffes[i]] = markers[giraffes[i]];
}



// 定义新坐标和初始坐标

// 定义一个函数，生成指定范围内的随机数
function getRandomNumber(min, max) {
    return Math.random() * (max - min) + min;
}

// 定义一个函数，生成新的坐标对象，并添加随机数
function RandomCoords(coords) {
    var randomLat = coords.lat + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
    var randomLng = coords.lng + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
    return { lat: randomLat, lng: randomLng };
}


var newCoords_giraffe2_1= RandomCoords(beijing);
var newCoords_giraffe3_1= RandomCoords(beijing);
var newCoords_giraffe4_1= RandomCoords(beijing);
var newCoords_giraffe5_1= RandomCoords(beijing);
var newCoords_giraffe6_1= RandomCoords(beijing);



var luoyang= {lat:34.6321,lng:112.4470}//洛阳
var kaifeng ={lat:34.7872,lng:114.3081};//开封
var beijing ={lat:39.9171,lng:116.3797};//北京
var xian= {lat:34.2655,lng:108.9508};//西安



//河西走廊:敦煌-酒泉-张掖-武威
var dunhuang= { lat:	40.1130	,lng:94.6618 }; 
var wuwei = {lat:37.9283,lng:102.6371};
var jiuquan={lat:39.7237,lng:98.3444}
var zhangye = {lat:38.9177,lng:100.3065};
//海上絲路：古里-xilan-palk-馬六甲
var guli ={lat:11.2618,lng:75.7822};
var xilan={lat:6.9397,lng:79.8259};
var palk={lat:10.0803,lng:80.1207};
var maliujia={lat:2.2373,lng:102.1691};
var kailuo={lat:	30.0444 ,lng:31.2357};
var kemolin={lat:8.0864,lng:77.5355};
var jibudi={lat:11.8125,lng:41.9678};
var taihai={lat:24.2877,lng:119.5445};
var zhangjiagang={lat:31.8774,lng:120.4609};
var nanhai={lat:-0.3778,lng:106.0436};


function getInitialCoords(giraffe) {
    const position = giraffe.getPosition();
    return {
        lat: position.lat(),
        lng: position.lng()
    };
}
var initialCoords_giraffe2 = getInitialCoords(giraffe2);
var initialCoords_giraffe3 = getInitialCoords(giraffe3);
var initialCoords_giraffe4 = getInitialCoords(giraffe4);
var initialCoords_giraffe5 = getInitialCoords(giraffe5);
var initialCoords_giraffe6 = getInitialCoords(giraffe6);





// 添加滑块值变化的事件监听器
slider.addEventListener('input', function() {
    
    handleToggleMarkers(currentValue)
   
    //史前之前
    if (currentValue<=0)
    {
        
        markers.giraffe2.setPosition(initialCoords_giraffe2);
        markers.giraffe3.setPosition(initialCoords_giraffe3);
        markers.giraffe4.setPosition(initialCoords_giraffe4);
        markers.giraffe5.setPosition(initialCoords_giraffe5);
        markers.giraffe6.setPosition(initialCoords_giraffe6);

        
     
    }
    //史前
    if(currentValue>0&&currentValue<1000)
    {
       
     
    }
    //秦汉
    if (currentValue >= 1000 && currentValue < 2000) {
        
        
    
    }
    //三国
    if (currentValue >= 2000 && currentValue <3000) {
       
    
    }
    //隋
    if(currentValue>=3000&&currentValue<4000){
        

          
        
    }
    //唐
    if (currentValue >= 4000 && currentValue < 5000) {



    }
    //宋
    if (currentValue >= 5000 && currentValue <6000) {
        

        

    }
    //元
    if (currentValue >= 6000 && currentValue <7000) {
       
  
       
    
    }
   //明
   if(currentValue >=7000 && currentValue <8000){
      
        var points_2 = [initialCoords_giraffe2,  maliujia,taihai,zhangjiagang,newCoords_giraffe2_1, newCoords_giraffe2_1];
        var points_3 = [initialCoords_giraffe3,  guli,palk,maliujia,taihai,zhangjiagang,newCoords_giraffe3_1, newCoords_giraffe3_1];
        var points_4 = [initialCoords_giraffe4,  guli,xilan,maliujia,maliujia,taihai,zhangjiagang,newCoords_giraffe4_1, newCoords_giraffe4_1];
        var points_5 = [initialCoords_giraffe5,  jibudi,guli,xilan,maliujia,taihai,zhangjiagang,newCoords_giraffe5_1, newCoords_giraffe5_1];
        var points_6 = [initialCoords_giraffe6,  guli,xilan,palk,maliujia,taihai,taihai,zhangjiagang,newCoords_giraffe6_1, newCoords_giraffe6_1];
        
    // 计算当前阶段的目标点的索引
        var targetIndex_2 = Math.floor((currentValue - 7000) / (1000 / (points_2.length-1)));
        var targetIndex_3 = Math.floor((currentValue - 7000) / (1000 / (points_3.length-1)));
        var targetIndex_4 = Math.floor((currentValue - 7000) / (1000 / (points_4.length-1)));
        var targetIndex_5 = Math.floor((currentValue - 7000) / (1000 / (points_5.length-1)));
        var targetIndex_6 = Math.floor((currentValue - 7000) / (1000 / (points_6.length-1)));
        

    // 计算插值百分比
        var percentage_2 = (currentValue - 7000) % (1000 / (points_2.length-1)) / (1000 / (points_2.length-1));
        var percentage_3 = (currentValue - 7000) % (1000 / (points_3.length-1)) / (1000 / (points_3.length-1));
        var percentage_4 = (currentValue - 7000) % (1000 / (points_4.length-1)) / (1000 / (points_4.length-1));
        var percentage_5 = (currentValue - 7000) % (1000 / (points_5.length-1)) / (1000 / (points_5.length-1));
        var percentage_6 = (currentValue - 7000) % (1000 / (points_6.length-1)) / (1000 / (points_6.length-1));
        

        percentage_2 = Math.min(1, Math.max(0, percentage_2));
        percentage_3 = Math.min(1, Math.max(0, percentage_3));
        percentage_4 = Math.min(1, Math.max(0, percentage_4));
        percentage_5 = Math.min(1, Math.max(0, percentage_5));
        percentage_6 = Math.min(1, Math.max(0, percentage_6));
        

    // 计算插值的新位置

        var latDiff = points_2[targetIndex_2 + 1].lat - points_2[targetIndex_2].lat;
        var lngDiff = points_2[targetIndex_2 + 1].lng - points_2[targetIndex_2].lng;
        var interpolatedLat_2 = points_2[targetIndex_2].lat + latDiff * percentage_2
        var interpolatedLng_2 = points_2[targetIndex_2].lng + lngDiff * percentage_2

        
        var latDiff = points_3[targetIndex_3 + 1].lat - points_3[targetIndex_3].lat;
        var lngDiff = points_3[targetIndex_3 + 1].lng - points_3[targetIndex_3].lng;
        var interpolatedLat_3 = points_3[targetIndex_3].lat + latDiff * percentage_3
        var interpolatedLng_3 = points_3[targetIndex_3].lng + lngDiff * percentage_3

        var latDiff = points_4[targetIndex_4 + 1].lat - points_4[targetIndex_4].lat;
        var lngDiff = points_4[targetIndex_4 + 1].lng - points_4[targetIndex_4].lng;
        var interpolatedLat_4 = points_4[targetIndex_4].lat + latDiff * percentage_4
        var interpolatedLng_4 = points_4[targetIndex_4].lng + lngDiff * percentage_4

        var latDiff = points_5[targetIndex_5 + 1].lat - points_5[targetIndex_5].lat;
        var lngDiff = points_5[targetIndex_5 + 1].lng - points_5[targetIndex_5].lng;
        var interpolatedLat_5 = points_5[targetIndex_5].lat + latDiff * percentage_5
        var interpolatedLng_5 = points_5[targetIndex_5].lng + lngDiff * percentage_5

        var latDiff = points_6[targetIndex_6 + 1].lat - points_6[targetIndex_6].lat;
        var lngDiff = points_6[targetIndex_6 + 1].lng - points_6[targetIndex_6].lng;
        var interpolatedLat_6 = points_6[targetIndex_6].lat + latDiff * percentage_6
        var interpolatedLng_6 = points_6[targetIndex_6].lng + lngDiff * percentage_6

        
        
        

        giraffe2.setPosition({ lat: interpolatedLat_2, lng: interpolatedLng_2 });     
        giraffe3.setPosition({ lat: interpolatedLat_3, lng: interpolatedLng_3 });
        giraffe4.setPosition({ lat: interpolatedLat_4, lng: interpolatedLng_4 });
        giraffe5.setPosition({ lat: interpolatedLat_5, lng: interpolatedLng_5 });
        giraffe6.setPosition({ lat: interpolatedLat_6, lng: interpolatedLng_6 });     
        
    }

    //清
    if(currentValue >=8000 && currentValue <=9000){
       
        
        
    }
    
    
});










