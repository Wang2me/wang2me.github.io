
//<br>&emsp;&emsp;&emsp;
//史前至夏商周
{

 
}


 //秦漢
{
    markers.coral1 = createMarker({lat:34.0010,lng:71.4974}, 'coral','巴基斯坦白沙瓦',{ A:['coral'], B:['秦漢'],C:['身份象徵'],D:['陸上絲綢之路'],E:['南亞'] }
,{  title_cn: '描述',title_en: 'Description',
    description_cn: '珊瑚蟲是一種古老的海洋動物。而我們所熟悉的作為裝飾品的珊瑚則是這種生物分泌碳酸鈣並大量堆積的結果。隨著陸上絲綢之路的開闢，漢朝時的中國人就已經瞭解到這種寶物。例如，位於南亞的罽賓國就是一個出產珊瑚的西域國家。'
    ,description_en:'Coral polyps are an ancient marine animal. Coral polyps are an ancient marine animal. The corals we familiar as decoration are the product of these creatures that secrete calcium carbonate to form a hard skeleton. With the opening of the Continental Silk Road, the Chinese during the Han Dynasty 漢朝 were already informed of this treasure. For example, the Jibin 罽賓 in South Asia was a kingdom in the Western Regions that produced coral.'
,reference:'1. 班固，《漢書·西域傳第六十六上》（北京：中華書局，1997），頁3885。'
    ,imag:''
    ,referenceUrl:''
 });
									
                                  
                 
}
//三国
{ 
markers.coral2 = createMarker({lat:33.3076,lng:44.3180}, 'coral','伊拉克巴格達',{ A:['coral'], B:['三國兩晉南北朝'],C:['身份象徵'],D:['陸上絲綢之路'],E:['西亞'] },
{title_cn: '描述',title_en: 'Description'  
,description_cn:'玳薩珊王朝，又稱波斯第二帝國，統治西亞地區長達四個世紀。南北朝時期，薩珊王朝和中國有著頻繁的官方往來。在北魏的史料中，薩珊王朝是大型珊瑚的產地。通過陸上絲綢之路，這些珍貴的珊瑚源源不斷地傳入中國。瑁是由大型陸龜或者海龜（主要是玳瑁海龜）的背甲製成的奢侈品材料。在古代中國，廣東地區是玳瑁的主要來源地之一。漢代的商人們往往前往番禺（今廣東廣州）進行玳瑁貿易。'  
,description_en:'The Sassanid Empire, also known as the Second Persian Empire, ruled West Asia for four centuries. During the Northern and Southern Dynasties 南北朝, the Sassanid Empire had frequent official contacts with China. In the historical records of the Northern Wei Dynasty 北魏, the Sassanids were the origin of large corals. Through the Continental Silk Road, these precious corals were continuously imported into China.'
,reference:'1. 魏收，《魏書·列傳第九十》（北京：中華書局，1997），頁2270-2271。'  
,image:''
,referenceUrl:''
	
                             
 
});


markers.coral3 = createMarker({lat:4.4990,lng:114.4864}, 'coral','文萊',{ A:['coral'], B:['唐'],C:['朝貢'],D:['海上絲綢之路'],E:['東南亞']},
{title_cn: '描述',title_en: 'Description'  
,description_cn:'《職貢圖》是中國古代的一種紀實性繪畫，其主要內容是外國使者的朝貢情況。台北故宮博物院收藏了一卷唐代畫家閻立本創作的《職貢圖》。研究者們認為這幅圖描繪了古代東南亞地區的使者們向唐朝進貢的情景。在這幅圖中可以看到使者們攜帶了大量不同尺寸的珊瑚。'  
,description_en:'The "Portraits of Periodical Offering" are documentary paintings in ancient China, which mainly represent the tributary by foreign envoys. The National Palace Museum in Taipei houses a roll of this painting created by the Tang Dynasty 唐朝 painter Yan Liben 閻立本. Researchers believe that this painting depicts the tribute journey from ancient Southeastern Asia to the Tang Dynasty. In this painting, it can be seen that the envoys were carrying a large number of corals of different sizes.'
,reference:'1. 唐閻立本職貢圖卷，國立故宮博物院，digitalarchive.npm.gov.tw/Painting/Content?pid=25&Dept=P。'
,image:'media/OneDrive_1_2024-1-8/497. (Tang Dynasty, Tribute Bearers by Yan Liben, housed in National Palace Museum).jpeg'
,image_content_cn:'唐，閻立本職貢圖卷，國立故宮博物院藏'
,image_content_en:'Tang Dynasty, Tribute Bearers by Yan Liben, housed in National Palace Museum'
   ,referenceUrl:''});				
//越南順華，陝西西安	-
                   
}

//隋
{


}

//唐
{
         
 markers.coral4 = createMarker({lat:12.8116,lng:45.0245}, 'coral','也門亞丁',{ A:['coral'], B:['宋'],C:['身份象徵'],D:['海上絲綢之路'],E:['西亞'] },
 {title_cn: '描述',title_en: 'Description'  
  ,description_cn:'宋朝及其重視商業發展，尤其是與外國的海上貿易。開寶四年（公元971年），北宋在廣州設立市舶司對海上貿易進行管理，其功能類似於現代的海關。許多阿拉伯、南亞、東南亞國家的商人匯集在廣州經商，廣州由此成為宋代的經濟中心之一。珊瑚是宋朝官方通過廣州進口的常見奢侈品。朝及其重視商業發展，尤其是與外國的海上貿易。開寶四年（公元971年），北宋在廣州設立市舶司對海上貿易進行管理，其功能類似於現代的海關。許多阿拉伯、南亞、東南亞國家的商人匯集在廣州經商，廣州由此成為宋代的經濟中心之一。珊瑚是宋朝官方通過廣州進口的常見奢侈品。'  
  ,description_en:'In 971, the Northern Song Dynasty 北宋 established the Shibosi 市舶司 in Guangzhou 廣州 to manage maritime trade. Later, the Shibosi was established in Hangzhou 杭州 and Mingzhou 明州 (present-day Ningbo 寧波, Zhejiang 浙江), which functions like a modern-day customs office. Businessmen from the Arabian, South Asian, and Southeast Asian countries converged on Guangzhou, resulting in the city being one of the economic centers of the Song Dynasty 宋朝. Corals were common luxury goods imported officially through Guangzhou during the Song Dynasty.'
 ,reference:'1. 脫脫等，《宋史·志第一百三十九》（北京：中華書局，1997），頁4558-4559。'
  ,image:''
  ,referenceUrl:''});
 //伊朗米納卜，印度孟買，印度尼西亞北加浪岸，文萊，越南藩切，廣州	-lat:27.1350845,lng:57.0505-lat:19.0833572,lng:72.8384-lat:-6.8915866,lng:109.6739-lat:4.4990189,lng:114.4864-lat:10.9255322,lng:108.07855-lat:23.1319466,lng:113.2588
  
  
markers.coral5 = createMarker({lat:13.7266,lng:100.5105}, 'coral','泰國曼谷',{ A:['coral'],B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['東南亞'] },
{title_cn: '描述',title_en: 'Description'  
 ,description_cn:'泰國在明朝時被稱為暹羅。鄭和下西洋時曾多次到達暹羅並進行貿易。暹羅經常前往明朝進行朝貢，珊瑚是常見的來自暹羅的貢品。'  
 ,description_en:'Zheng He 鄭和 visited Thailand and traded there several times during his voyages to the West. Thailand regularly paid tribute to the Ming Dynasty 明朝. Corals were common tribute from Thailand.'
,reference:'1. 張廷玉等，《明史·列傳第二百十二》（北京：中華書局，1997），頁8403。'
 ,imag:''
 ,referenceUrl:''});		
 
markers.coral6 = createMarker({ lat:2.2049,lng:102.2426}, 'coral','馬來西亞馬六甲',{ A:['coral'],B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['東南亞'] },
{title_cn: '描述',title_en: 'Description'  
 ,description_cn:'馬六甲蘇丹國，在《明史》中被稱為滿剌加。鄭和下西洋時，其國王跟隨鄭和一同返回，成為了明王朝的藩屬國。該國地處馬六甲海峽，是連接印度洋和太平洋的必經之路，也是古代東西方海上貿易的中轉站。因此，當地的奢侈品貿易非常繁榮。根據記載，珊瑚是常見的來自於滿剌加的貢品。'  
 ,description_en:'Zheng He 鄭和 once reached Malacca Sultanate on his ocean voyages. The Malacca Sultanate became a tributary of the Ming Dynasty 明朝 and maintain a close relationship for a long time. Located in the Strait of Malacca, the state was an essential route connecting the Indian and Pacific Oceans and was also a transit point for the ancient maritime trade between the East and the West. Therefore, the trade of luxury goods was very prosperous in the region. It is recorded that tcorals were common tribute from Malacca Sultanate.'
,reference:'1. 張廷玉等，《明史·列傳第二百十三》（北京：中華書局，1997），頁8419。'
 ,image:''
 ,referenceUrl:''});
//，廣東廣州，江蘇南京，北京	-lat:23.1093552,lng:113.0934-lat:32.0689363,lng:118.7829


markers.coral7 = createMarker({ lat:7.6802,lng:80.6327}, 'coral','斯里蘭卡',{ A:['coral'],B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['南亞'] },
   {title_cn: '描述',title_en: 'Description'  
    ,description_cn:'斯里蘭卡在明代時被稱為錫蘭山。錫蘭山國的使者曾多次跟隨鄭和船隊來到明朝進貢。錫蘭山在永樂時期曾進貢過珊瑚。'  
    ,description_en:'Envoys from Sri Lanka visited China several times with Zheng He\'s 鄭和 fleets. During the Yongle 永樂 period, Sri Lanka paid tribute to the Ming Dynasty 明朝 with corals.'
   ,reference:'1. 張廷玉等，《明史·列傳第二百十四》（北京：中華書局，1997），頁8445。'
    ,image:''
    ,referenceUrl:''});	     

       
   markers.coral8 = createMarker({lat:12.8116,lng:45.0245}, 'coral','也門亞丁',{ A:['coral'],B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['西亞'] },
   {title_cn: '描述',title_en: 'Description'  
    ,description_cn:'亞丁在明代被稱為阿丹。據史書記載，阿丹國王十分崇敬中國，用大量珍寶與鄭和進行貿易。永樂十九年（公元1421年），鄭和的使者從阿丹帶回數座大型的珊瑚。'  
    ,description_en:'The king of Aden greatly respected the Ming Dynasty 明朝 and traded with Zheng He 鄭和 for a large number of treasures. In 1421, Zheng He\'s envoys imported several large corals from the Aden.'
   ,reference:'1. 張廷玉等，《明史·列傳第二百十四》（北京：中華書局，1997），頁8450。'
    ,image:''
    ,referenceUrl:''});
    
}

//宋
{
   



}
//元
{

     
  
	

}

//清
{
	
  
 
 }
        

// 获取时间轴元素和标记
var timeline = document.getElementById('timeline');
var slider = document.getElementById('slider');
var corals = [
 'coral1', 'coral2', 'coral3', 'coral4', 'coral5', 'coral6', 'coral7', 'coral8'

];

for (var i = 0; i < corals.length; i++) {
 window[corals[i]] = markers[corals[i]];
}



// 定义新坐标和初始坐标

// 定义一个函数，生成指定范围内的随机数
function getRandomNumber(min, max) {
 return Math.random() * (max - min) + min;
}

// 定义一个函数，生成新的坐标对象，并添加随机数
function RandomCoords(coords) {
 var randomLat = coords.lat + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
 var randomLng = coords.lng + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
 return { lat: randomLat, lng: randomLng };
}

var xian= {lat:34.2655,lng:108.9508};//西安
var luoyang= {lat:34.6321,lng:112.4470}//洛阳
var kaifeng ={lat:34.7872,lng:114.3081};//开封
var beijing ={lat:39.9171,lng:116.3797};//北京
var nanjing={lat:32.0435,lng:118.7501}//南京


var newCoords_coral1_1= RandomCoords(xian);
var newCoords_coral2_1= RandomCoords(luoyang);

var newCoords_coral3_1= {lat:16.4533611,lng:107.5881};
var newCoords_coral3_2= RandomCoords(xian);
 //伊朗米納卜，印度孟買，印度尼西亞北加浪岸，文萊，越南藩切，廣州	------

var newCoords_coral4_1= {lat:27.1350845,lng:57.0505};
var newCoords_coral4_2= {lat:19.0833572,lng:72.8384};
var newCoords_coral4_3= {lat:-6.8915866,lng:109.6739};
var newCoords_coral4_4= {lat:4.4990189,lng:114.4864};
var newCoords_coral4_5= {lat:10.9255322,lng:108.07855};
var newCoords_coral4_6= {lat:23.1319466,lng:113.2588};

var newCoords_coral5_1= RandomCoords(beijing);

var newCoords_coral6_1= {lat:23.1093552,lng:113.0934};
var newCoords_coral6_2= RandomCoords(nanjing);
var newCoords_coral6_3= RandomCoords(beijing);

var newCoords_coral7_1= RandomCoords(beijing);
var newCoords_coral8_1= RandomCoords(beijing);








//河西走廊:敦煌-酒泉-张掖-武威
var dunhuang= { lat:	40.1130	,lng:94.6618 }; 
var wuwei = {lat:37.9283,lng:102.6371};
var jiuquan={lat:39.7237,lng:98.3444}
var zhangye = {lat:38.9177,lng:100.3065};
//海上絲路：古里-xilan-palk-馬六甲
var guli ={lat:11.2618,lng:75.7822};
var xilan={lat:6.9397,lng:79.8259};
var palk={lat:10.0803,lng:80.1207};
var maliujia={lat:2.2373,lng:102.1691};
var kailuo={lat:	30.0444 ,lng:31.2357};
var kemolin={lat:8.0864,lng:77.5355};
var jibudi={lat:11.8125,lng:41.9678};
var taihai={lat:24.2877,lng:119.5445};
var zhangjiagang={lat:31.8774,lng:120.4609};
var nanhai={lat:-0.3778,lng:106.0436};


function getInitialCoords(coral) {
 const position = coral.getPosition();
 return {
     lat: position.lat(),
     lng: position.lng()
 };
}


var initialCoords_coral1 = getInitialCoords(coral1);
var initialCoords_coral2 = getInitialCoords(coral2);
var initialCoords_coral3 = getInitialCoords(coral3);
var initialCoords_coral4 = getInitialCoords(coral4);
var initialCoords_coral5 = getInitialCoords(coral5);
var initialCoords_coral6 = getInitialCoords(coral6);
var initialCoords_coral7 = getInitialCoords(coral7);
var initialCoords_coral8 = getInitialCoords(coral8);

// 添加滑块值变化的事件监听器
slider.addEventListener('input', function() {
    
   // handleToggleMarkers(currentValue)
   
    //史前之前
    if (currentValue<=0)
    {
        markers.coral1.setPosition(initialCoords_coral1);
        markers.coral2.setPosition(initialCoords_coral2);
        markers.coral3.setPosition(initialCoords_coral3);
        markers.coral4.setPosition(initialCoords_coral4);
        markers.coral5.setPosition(initialCoords_coral5);
        markers.coral6.setPosition(initialCoords_coral6);
        markers.coral7.setPosition(initialCoords_coral7);
        markers.coral8.setPosition(initialCoords_coral8);

    }
    //史前
    if(currentValue>0&&currentValue<1000)
    {
        
     
    }
    //秦汉
    if (currentValue >= 1000 && currentValue < 2000) {
        var points_1 = [initialCoords_coral1,  dunhuang,wuwei,newCoords_coral1_1, newCoords_coral1_1];
        
        
        
        // 计算当前阶段的目标点的索引
            
            var targetIndex_1 = Math.floor((currentValue - 1000) / (1000 / (points_1.length-1)));
            
    
    
    
        // 计算插值百分比
           
            var percentage_1 = (currentValue - 1000) % (1000 / (points_1.length-1)) / (1000 / (points_1.length-1));
            
    
            
            percentage_1 = Math.min(1, Math.max(0, percentage_1));
            
    
    
        // 计算插值的新位置
            
            
            var latDiff = points_1[targetIndex_1 + 1].lat - points_1[targetIndex_1].lat;
            var lngDiff = points_1[targetIndex_1 + 1].lng - points_1[targetIndex_1].lng;
            var interpolatedLat_1 = points_1[targetIndex_1].lat + latDiff * percentage_1
            var interpolatedLng_1 = points_1[targetIndex_1].lng + lngDiff * percentage_1
            
            
    
            
    
      
            
            coral1.setPosition({ lat: interpolatedLat_1, lng: interpolatedLng_1 });  
            
    }
    //三国
    if (currentValue >= 2000 && currentValue <3000) {
        var points_2 = [initialCoords_coral2, dunhuang,wuwei, newCoords_coral2_1, newCoords_coral2_1];
        
        
        
        // 计算当前阶段的目标点的索引
            
            var targetIndex_2 = Math.floor((currentValue - 2000) / (1000 / (points_2.length-1)));
            
    
    
    
        // 计算插值百分比
           
            var percentage_2 = (currentValue - 2000) % (1000 / (points_2.length-1)) / (1000 / (points_2.length-1));
            
    
            
            percentage_2 = Math.min(1, Math.max(0, percentage_2));
            
    
    
        // 计算插值的新位置
            
            
            var latDiff = points_2[targetIndex_2 + 1].lat - points_2[targetIndex_2].lat;
            var lngDiff = points_2[targetIndex_2 + 1].lng - points_2[targetIndex_2].lng;
            var interpolatedLat_2 = points_2[targetIndex_2].lat + latDiff * percentage_2
            var interpolatedLng_2 = points_2[targetIndex_2].lng + lngDiff * percentage_2
            
            
    
            
    
      
            
            coral2.setPosition({ lat: interpolatedLat_2, lng: interpolatedLng_2 });  
    }
    //隋
    if(currentValue>=3000&&currentValue<4000){

    }
    //唐
    if (currentValue >= 4000 && currentValue < 5000) {
        var points_3 = [initialCoords_coral3,newCoords_coral3_1, newCoords_coral3_2,newCoords_coral3_2];
   
        // 计算当前阶段的目标点的索引
            var targetIndex_3 = Math.floor((currentValue -4000) / (1000 / (points_3.length-1)));
            
        // 计算插值百分比
            var percentage_3 = (currentValue -4000) % (1000 / (points_3.length-1)) / (1000 / (points_3.length-1));
            
            
            percentage_3 = Math.min(1, Math.max(0, percentage_3));
            
            
        // 计算插值的新位置
            
    
            var latDiff = points_3[targetIndex_3 + 1].lat - points_3[targetIndex_3].lat;
            var lngDiff = points_3[targetIndex_3 + 1].lng - points_3[targetIndex_3].lng;
            var interpolatedLat_3 = points_3[targetIndex_3].lat + latDiff * percentage_3;
            var interpolatedLng_3 = points_3[targetIndex_3].lng + lngDiff * percentage_3;
    
            
            
        // 设置coral23的位置
            coral3.setPosition({ lat: interpolatedLat_3, lng: interpolatedLng_3 });
            
        }
       

    
    //宋
    if (currentValue >= 5000 && currentValue <6000) {
        var points_4 = [initialCoords_coral4,  newCoords_coral4_1, newCoords_coral4_2,newCoords_coral4_3,newCoords_coral4_4,newCoords_coral4_5,newCoords_coral4_6,newCoords_coral4_6];
       
        
        
    // 计算当前阶段的目标点的索引
        var targetIndex_4 = Math.floor((currentValue - 5000) / (1000 / (points_4.length-1)));
        



    // 计算插值百分比
        var percentage_4 = (currentValue - 5000) % (1000 / (points_4.length-1)) / (1000 / (points_4.length-1));
       

        percentage_4 = Math.min(1, Math.max(0, percentage_4));
       


    // 计算插值的新位置
        

        var latDiff = points_4[targetIndex_4 + 1].lat - points_4[targetIndex_4].lat;
        var lngDiff = points_4[targetIndex_4 + 1].lng - points_4[targetIndex_4].lng;
        var interpolatedLat_4 = points_4[targetIndex_4].lat + latDiff * percentage_4
        var interpolatedLng_4 = points_4[targetIndex_4].lng + lngDiff * percentage_4

        

  
        coral4.setPosition({ lat: interpolatedLat_4, lng: interpolatedLng_4 }); 
       
    }
    //元
    if (currentValue >= 6000 && currentValue <7000) {
   
           
    
    }
   //明
    if(currentValue >=7000 && currentValue <8000){
        
        var points_5 = [initialCoords_coral5, maliujia,taihai,zhangjiagang,newCoords_coral5_1, newCoords_coral5_1];
        var points_6 = [initialCoords_coral6, taihai,newCoords_coral6_1, newCoords_coral6_2,newCoords_coral6_3,newCoords_coral6_3];
        var points_7 = [initialCoords_coral7, maliujia,taihai,zhangjiagang,zhangjiagang,newCoords_coral7_1, newCoords_coral7_1];
        var points_8 = [initialCoords_coral8, guli,xilan,maliujia,taihai,newCoords_coral8_1, newCoords_coral8_1];

    // 计算当前阶段的目标点的索引
       
        var targetIndex_5 = Math.floor((currentValue - 7000) / (1000 / (points_5.length-1)));
        var targetIndex_8 = Math.floor((currentValue - 7000) / (1000 / (points_8.length-1)));
        var targetIndex_7 = Math.floor((currentValue - 7000) / (1000 / (points_7.length-1)));
        var targetIndex_6 = Math.floor((currentValue - 7000) / (1000 / (points_6.length-1)));


    // 计算插值百分比
        
        var percentage_5 = (currentValue - 7000) % (1000 / (points_5.length-1)) / (1000 / (points_5.length-1));
        var percentage_8 = (currentValue - 7000) % (1000 / (points_8.length-1)) / (1000 / (points_8.length-1));
        var percentage_7 = (currentValue - 7000) % (1000 / (points_7.length-1)) / (1000 / (points_7.length-1));
        var percentage_6 = (currentValue - 7000) % (1000 / (points_6.length-1)) / (1000 / (points_6.length-1));


        
        percentage_5 = Math.min(1, Math.max(0, percentage_5));
        percentage_8 = Math.min(1, Math.max(0, percentage_8));
        percentage_7 = Math.min(1, Math.max(0, percentage_7));
        percentage_6 = Math.min(1, Math.max(0, percentage_6));


    // 计算插值的新位置
        

        var latDiff = points_5[targetIndex_5 + 1].lat - points_5[targetIndex_5].lat;
        var lngDiff = points_5[targetIndex_5 + 1].lng - points_5[targetIndex_5].lng;
        var interpolatedLat_5 = points_5[targetIndex_5].lat + latDiff * percentage_5
        var interpolatedLng_5 = points_5[targetIndex_5].lng + lngDiff * percentage_5

        
        var latDiff = points_8[targetIndex_8 + 1].lat - points_8[targetIndex_8].lat;
        var lngDiff = points_8[targetIndex_8 + 1].lng - points_8[targetIndex_8].lng;
        var interpolatedLat_8 = points_8[targetIndex_8].lat + latDiff * percentage_8
        var interpolatedLng_8 = points_8[targetIndex_8].lng + lngDiff * percentage_8

        var latDiff = points_7[targetIndex_7 + 1].lat - points_7[targetIndex_7].lat;
        var lngDiff = points_7[targetIndex_7 + 1].lng - points_7[targetIndex_7].lng;
        var interpolatedLat_7 = points_7[targetIndex_7].lat + latDiff * percentage_7
        var interpolatedLng_7 = points_7[targetIndex_7].lng + lngDiff * percentage_7
    
        var latDiff = points_6[targetIndex_6 + 1].lat - points_6[targetIndex_6].lat;
        var lngDiff = points_6[targetIndex_6 + 1].lng - points_6[targetIndex_6].lng;
        var interpolatedLat_6 = points_6[targetIndex_6].lat + latDiff * percentage_6
        var interpolatedLng_6 = points_6[targetIndex_6].lng + lngDiff * percentage_6

        
        coral5.setPosition({ lat: interpolatedLat_5, lng: interpolatedLng_5 });     
        coral8.setPosition({ lat: interpolatedLat_8, lng: interpolatedLng_8 });
        coral7.setPosition({ lat: interpolatedLat_7, lng: interpolatedLng_7 });
        coral6.setPosition({ lat: interpolatedLat_6, lng: interpolatedLng_6 });
       
    
    }

    //清
    if(currentValue >=8000 && currentValue <=9000){
        
    }


});




