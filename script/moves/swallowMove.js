//<br>&emsp;&emsp;&emsp;
markers.swallow1 = createMarker({ lat:5.9762,lng:116.0468}, 'swallow','馬來西亞哥打基纳巴鲁',{ A:['swallow'], B:['唐'],C:['飲食'],D:['其他'],E:['東南亞'] }
   ,{  title_cn: '描述',title_en: 'Description'
       ,description_cn: '燕窩，是混合了金絲燕唾液的鳥巢，被人們收集以作食用或藥用。食用燕窩的歷史已經有數百年的時間。在馬來西亞沙巴的一處考古遺跡中，考古學家發現了部分烹飪燕窩的工具。他們推測，唐代時的馬來西亞已經開始採集和使用燕窩。'
       ,description_en: 'Edible bird\'s nests, also known as swallow nests, are bird nests mixed with the saliva of swiftlets, which are harvested for food or medicinal purposes. The history of edible bird\'s nests has been around for hundreds of years. In an archaeological site in Sabah, Malaysia, archaeologists found some of the tools used to cook edible bird\'s nests. It is believed that the collection and consumption of edible bird\'s nests started in Malaysia during the Tang Dynasty 唐朝.'
	   ,reference:'1. 馮立軍，〈略論明清時期中國與東南亞的燕窩貿易〉，《中國經濟史研究》，期2（2015年3月），頁104。'
       ,imag:''
       ,referenceUrl:''
    });			
  										
    
markers.swallow2 = createMarker({ lat:17.4515,lng:106.5344}, 'swallow','越南廣平',{ A:['swallow'], B:['元'],C:['飲食'],D:['海上絲綢之路'],E:['東南亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'最早關於燕窩的中文文字記載可追溯至元朝。因此，歷史學家們推測古代中國與東南亞的燕窩貿易可能始於元朝。元朝皇室和蒙古貴族所食用的燕窩主要來自越南中部地區，通過廣州進口。'  
	,description_en:'The earliest written record of edible bird\'s nests in Chinese dates back to the Yuan Dynasty 元朝. Therefore, historians speculate that the trade of edible bird\'s nests between ancient China and Southeast Asia probably started from the Yuan Dynasty. The edible bird\'s nests consumed by the Mongolian royal family and nobles mainly came from the central region of Vietnam and were imported through Guangzhou 廣州.'
	,reference:'1. 馮立軍，〈略論明清時期中國與東南亞的燕窩貿易〉，《中國經濟史研究》，期2（2015年3月），頁104-105。'  
	,image:''
	,referenceUrl:''
    });
//廣東廣州，北京	-lat:23.1256161,lng:113.2407
    
markers.swallow3 = createMarker({ lat:13.6675,lng:100.5358}, 'swallow','泰國曼谷',{ A:['swallow'], B:['明'],C:['飲食'],D:['海上絲綢之路'],E:['東南亞']},
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'古代中國與東南亞的燕窩貿易在明朝有了進一步發展。來自泰國等地的燕窩通過海路源源不斷地輸入廣東地區。廣東惠州因此成為了明朝主要進口燕窩的港口之一。除了明朝皇室，東南沿海地區的官員也是燕窩的主要消費群體。自萬曆以後，明朝對燕窩貿易的稅額做出了明確的規定。'  
	,description_en:'The swallows nest trade between ancient China and Southeast Asia was further developed during the Ming Dynasty 明朝. Swallow nests from Thailand and other places were constantly imported into Guangdong 廣東 through the maritime route. As a result, Huizhou 惠州 in Guangdong became one of the major harbours for importing swallow nests during the Ming Dynasty. Besides the royal family of the Ming Dynasty, the officials of the Southeast Coast were also the main consumers of edible bird\'s nests. Since the Wanli 萬曆 period, the Ming Dynasty has made specific regulations on the tax on the trade of edible bird\'s nests.'
	 ,reference:'1. 馮立軍，〈略論明清時期中國與東南亞的燕窩貿易〉，《中國經濟史研究》，期2（2015年3月），頁106-107。'  
	,image:''
	,referenceUrl:''});
   	//廣東惠州，上海，南京，北京	-lat:23.1103563,lng:114.4103-lat:31.2188016,lng:121.4328-lat:32.0689363,lng:118.7829
   
markers.swallow4 = createMarker({lat:2.2022,lng:102.2391}, 'swallow','馬來西亞馬六甲',{ A:['swallow'], B:['明'],C:['飲食'],D:['海上絲綢之路'],E:['東南亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'馬六甲蘇丹國，在《明史》中被稱為滿剌加。鄭和下西洋時，其國王跟隨鄭和一同返回，成為了明王朝的藩屬國。該國地處馬六甲海峽，是連接印度洋和太平洋的必經之路，也是古代東西方海上貿易的中轉站。燕窩是明朝從滿剌加進口的主要商品之一。除了明朝皇室，東南沿海地區的官員也是燕窩的主要消費群體。'  
	,description_en:'Zheng He 鄭和 once reached Malacca Sultanate on his ocean voyages. The Malacca Sultanate became a tributary of the Ming Dynasty 明朝 and maintain a close relationship for a long time. Located in the Strait of Malacca, the state was an essential route connecting the Indian and Pacific Oceans and was also a transit point for the ancient maritime trade between the East and the West. Swallow nests were one of the major goods imported from Malacca during the Ming Dynasty. Besides the royal family of the Ming Dynasty, the officials of the Southeast Coast were also the main consumers of swallow nests.'
	 ,reference:'1. 馮立軍，〈略論明清時期中國與東南亞的燕窩貿易〉，《中國經濟史研究》，期2（2015年3月），頁106-107。'  
	,image:''
	,referenceUrl:''});
   //廣東惠州，北京	-lat:23.1034172,lng:114.3411
    
markers.swallow5 = createMarker({ lat:1.4727,lng:103.8922}, 'swallow','馬來西亞柔佛',{ A:['swallow'], B:['明'],C:['朝貢'],D:['海上絲綢之路'],E:['東南亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'柔佛位於馬來半島南部。明朝時，燕窩是常見的來自柔佛的貢物之一。'  
	,description_en:'Johor is located in the southern part of the Malay Peninsula. During the Ming Dynasty 明朝,  edible bird\'s nest was one of the most common tributes from Johor.'
	,reference:'1. 張廷玉等，《明史·列傳第二百十三》（北京：中華書局，1997），頁8429。'  
	,image:''
	,referenceUrl:''});

   
markers.swallow6 = createMarker({ lat:5.8389,lng:121.2555}, 'swallow','菲律賓蘇祿群島',{ A:['swallow'],B:['清'],C:['朝貢'],D:['海上絲綢之路'],E:['東南亞'] },
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'清代的燕窩貿易由福建和廣東地區的商人主導，在乾隆時期發展至頂峰。東南亞各地的燕窩先由廣東商人運輸至香港，再由福建商人轉運至廈門。其中優質的燕窩以朝貢的形式供給清朝皇室，其餘則流入市場。菲律賓的蘇祿群島是燕窩的主要產地之一。每年有數十艘商船往來於中國和蘇祿群島之間運輸燕窩。'  
	,description_en:'The trade of edible bird\'s nests in the Qing Dynasty 清朝 was dominated by merchants from Fujian 福建 and Guangdong 廣東, which reached its peak during the Qianlong 乾隆 period. Swallow nests from Southeast Asia were first transported to Hong Kong by Guangdong merchants and then to Xiamen 廈門 by Fujian merchants. The best quality bird\'s nests were supplied to the Qing royal family as tribute, while the rest flowed into the market. The Sulu Archipelago in the Philippines is one of the major sources of edible bird\'s nests. There were dozens of merchant ships transporting the nests between China and the Sulu Archipelago every year.	'
	 ,reference:'1. 馮立軍，〈略論明清時期中國與東南亞的燕窩貿易〉，《中國經濟史研究》，期2（2015年3月），頁109-111。<br>&emsp;&emsp;&emsp;2.  余昕，〈燕窩貿易的三重世界：南洋華人的價值理論、物質性與生產〉，《社會》，卷41（2021年4月），頁118-123。'  
	,image:''
	,referenceUrl:''});
 	//中國香港，福建廈門，北京	-lat:22.3204839,lng:114.1046-lat:24.4718852,lng:118.0841
    
markers.swallow7 = createMarker({ lat:-6.2253,lng:106.7283}, 'swallow','馬來西亞雅加達',{ A:['swallow'],B:['清'],C:['朝貢'],D:['海上絲綢之路'],E:['東南亞']},
   {title_cn: '描述',title_en: 'Description'  
	,description_cn:'清代的燕窩貿易由福建和廣東地區的商人主導，在乾隆時期發展至頂峰。東南亞各地的燕窩先由廣東商人運輸至香港，再由福建商人轉運至廈門。其中優質的燕窩以朝貢的形式供給清朝皇室，其餘則流入市場。爪哇島是燕窩的主要產地之一。光緒時期，每年有數千公斤的燕窩從爪哇島運輸至中國。'  
	,description_en:'The trade of edible bird\'s nests in the Qing Dynasty 清朝 was dominated by merchants from Fujian 福建 and Guangdong 廣東, which reached its peak during the Qianlong 乾隆 period. Swallow nests from Southeast Asia were first transported to Hong Kong by Guangdong merchants and then to Xiamen 廈門 by Fujian merchants. The best quality bird\'s nests were supplied to the Qing royal family as tribute, while the rest flowed into the market. Java is one of the major sources of edible bird\'s nests. During the Guangxu period 光緒, thousands of kilograms of swallow nests were transported from Java to China every year.'
    ,reference:'1. 馮立軍，〈略論明清時期中國與東南亞的燕窩貿易〉，《中國經濟史研究》，期2（2015年3月），頁111-112。<br>&emsp;&emsp;&emsp;2.  余昕，〈燕窩貿易的三重世界：南洋華人的價值理論、物質性與生產〉，《社會》，卷41（2021年4月），頁118-123。'
    ,image:''
	,referenceUrl:''});
    


    
// 获取时间轴元素和标记
var timeline = document.getElementById('timeline');
var slider = document.getElementById('slider');
var swallows = [
    'swallow1', 'swallow2', 'swallow3', 'swallow4', 'swallow5', 'swallow6', 'swallow7'
];

for (var i = 0; i < swallows.length; i++) {
    window[swallows[i]] = markers[swallows[i]];
}



// 定义新坐标和初始坐标

// 定义一个函数，生成指定范围内的随机数
function getRandomNumber(min, max) {
    return Math.random() * (max - min) + min;
}

// 定义一个函数，生成新的坐标对象，并添加随机数
function RandomCoords(coords) {
    var randomLat = coords.lat + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
    var randomLng = coords.lng + getRandomNumber(-0.05, 0.05); // 在-0.1到0.1之间生成随机数
    return { lat: randomLat, lng: randomLng };
}


var newCoords_swallow2_1= {lat:23.1256,lng:113.2407};
var newCoords_swallow2_2= RandomCoords(beijing);
var newCoords_swallow3_1= {lat:23.1103,lng:114.4103};
var newCoords_swallow3_2= {lat:31.2188,lng:121.4328};
var newCoords_swallow3_3= RandomCoords(nanjing);
var newCoords_swallow3_4= RandomCoords(beijing);
var newCoords_swallow4_1= {lat:23.1034,lng:114.3411};
var newCoords_swallow4_2= RandomCoords(beijing);
var newCoords_swallow5_1= RandomCoords(beijing);
var newCoords_swallow6_1= {lat:22.3204,lng:114.1046};
var newCoords_swallow6_2= {lat:24.4718,lng:118.0841};
var newCoords_swallow6_3= RandomCoords(beijing);

var newCoords_swallow7_1= {lat:22.3204,lng:114.1046};
var newCoords_swallow7_2= {lat:24.4718,lng:118.0841};
var newCoords_swallow7_3= RandomCoords(beijing);

var luoyang= {lat:34.6321,lng:112.4470}//洛阳
var kaifeng ={lat:34.7872,lng:114.3081};//开封
var beijing ={lat:39.9171,lng:116.3797};//北京
var xian= {lat:34.2655,lng:108.9508};//西安



//河西走廊:敦煌-酒泉-张掖-武威
var dunhuang= { lat:	40.1130	,lng:94.6618 }; 
var wuwei = {lat:37.9283,lng:102.6371};
var jiuquan={lat:39.7237,lng:98.3444}
var zhangye = {lat:38.9177,lng:100.3065};
//海上絲路：古里-xilan-palk-馬六甲
var guli ={lat:11.2618,lng:75.7822};
var xilan={lat:6.9397,lng:79.8259};
var palk={lat:10.0803,lng:80.1207};
var maliujia={lat:2.2373,lng:102.1691};
var kailuo={lat:	30.0444 ,lng:31.2357};
var kemolin={lat:8.0864,lng:77.5355};
var jibudi={lat:11.8125,lng:41.9678};
var taihai={lat:24.2877,lng:119.5445};
var zhangjiagang={lat:31.8774,lng:120.4609};
var nanhai={lat:-0.3778,lng:106.0436};


function getInitialCoords(swallow) {
    const position = swallow.getPosition();
    return {
        lat: position.lat(),
        lng: position.lng()
    };
}
var initialCoords_swallow2 = getInitialCoords(swallow2);
var initialCoords_swallow3 = getInitialCoords(swallow3);
var initialCoords_swallow4 = getInitialCoords(swallow4);
var initialCoords_swallow5 = getInitialCoords(swallow5);
var initialCoords_swallow6 = getInitialCoords(swallow6);
var initialCoords_swallow7 = getInitialCoords(swallow7);




// 添加滑块值变化的事件监听器
slider.addEventListener('input', function() {
    
    handleToggleMarkers(currentValue)
   
    //史前之前
    if (currentValue<=0)
    {
        
        markers.swallow2.setPosition(initialCoords_swallow2);
        markers.swallow3.setPosition(initialCoords_swallow3);
        markers.swallow4.setPosition(initialCoords_swallow4);
        markers.swallow5.setPosition(initialCoords_swallow5);
        markers.swallow6.setPosition(initialCoords_swallow6);
        markers.swallow7.setPosition(initialCoords_swallow7);
        
     
    }
    //史前
    if(currentValue>0&&currentValue<1000)
    {
       
     
    }
    //秦汉
    if (currentValue >= 1000 && currentValue < 2000) {
        
        
    
    }
    //三国
    if (currentValue >= 2000 && currentValue <3000) {
       
    
    }
    //隋
    if(currentValue>=3000&&currentValue<4000){
        

          
        
    }
    //唐
    if (currentValue >= 4000 && currentValue < 5000) {



    }
    //宋
    if (currentValue >= 5000 && currentValue <6000) {
        

        

    }
    //元
    if (currentValue >= 6000 && currentValue <7000) {
       
        var points_2 = [initialCoords_swallow2, newCoords_swallow2_1, newCoords_swallow2_2,newCoords_swallow2_2];
        
        // 计算当前阶段的目标点的索引
           
            
            var targetIndex_2 = Math.floor((currentValue - 6000) / (1000 / (points_2.length-1)));
           
        // 计算插值百分比
            
           
            var percentage_2 = (currentValue - 6000) % (1000 / (points_2.length-1)) / (1000 / (points_2.length-1));
            
            
            
            percentage_2 = Math.min(1, Math.max(0, percentage_2));
           
    
        // 计算插值的新位置
            
            
    
            
    
            
            var latDiff = points_2[targetIndex_2 + 1].lat - points_2[targetIndex_2].lat;
            var lngDiff = points_2[targetIndex_2 + 1].lng - points_2[targetIndex_2].lng;
            var interpolatedLat_2 = points_2[targetIndex_2].lat + latDiff * percentage_2
            var interpolatedLng_2 = points_2[targetIndex_2].lng + lngDiff * percentage_2 
           
            swallow2.setPosition({ lat: interpolatedLat_2, lng: interpolatedLng_2 });
       
    
    }
   //明
   if(currentValue >=7000 && currentValue <8000){
      
        var points_3 = [initialCoords_swallow3,  newCoords_swallow3_1, newCoords_swallow3_2,newCoords_swallow3_3,newCoords_swallow3_4];
        var points_4 = [initialCoords_swallow4,  newCoords_swallow4_1, newCoords_swallow4_2,newCoords_swallow4_2];
        var points_5 = [initialCoords_swallow5,  newCoords_swallow5_1, newCoords_swallow5_1];
        
    // 计算当前阶段的目标点的索引
        var targetIndex_3 = Math.floor((currentValue - 7000) / (1000 / (points_3.length-1)));
        var targetIndex_4 = Math.floor((currentValue - 7000) / (1000 / (points_4.length-1)));
        var targetIndex_5 = Math.floor((currentValue - 7000) / (1000 / (points_5.length-1)));
        

    // 计算插值百分比
        var percentage_3 = (currentValue - 7000) % (1000 / (points_3.length-1)) / (1000 / (points_3.length-1));
        var percentage_4 = (currentValue - 7000) % (1000 / (points_4.length-1)) / (1000 / (points_4.length-1));
        var percentage_5 = (currentValue - 7000) % (1000 / (points_5.length-1)) / (1000 / (points_5.length-1));
        

        percentage_3 = Math.min(1, Math.max(0, percentage_3));
        percentage_4 = Math.min(1, Math.max(0, percentage_4));
        percentage_5 = Math.min(1, Math.max(0, percentage_5));
        

    // 计算插值的新位置

        
        
        var latDiff = points_3[targetIndex_3 + 1].lat - points_3[targetIndex_3].lat;
        var lngDiff = points_3[targetIndex_3 + 1].lng - points_3[targetIndex_3].lng;
        var interpolatedLat_3 = points_3[targetIndex_3].lat + latDiff * percentage_3
        var interpolatedLng_3 = points_3[targetIndex_3].lng + lngDiff * percentage_3

        var latDiff = points_4[targetIndex_4 + 1].lat - points_4[targetIndex_4].lat;
        var lngDiff = points_4[targetIndex_4 + 1].lng - points_4[targetIndex_4].lng;
        var interpolatedLat_4 = points_4[targetIndex_4].lat + latDiff * percentage_4
        var interpolatedLng_4 = points_4[targetIndex_4].lng + lngDiff * percentage_4

        var latDiff = points_5[targetIndex_5 + 1].lat - points_5[targetIndex_5].lat;
        var lngDiff = points_5[targetIndex_5 + 1].lng - points_5[targetIndex_5].lng;
        var interpolatedLat_5 = points_5[targetIndex_5].lat + latDiff * percentage_5
        var interpolatedLng_5 = points_5[targetIndex_5].lng + lngDiff * percentage_5

        

        swallow3.setPosition({ lat: interpolatedLat_3, lng: interpolatedLng_3 });
        swallow4.setPosition({ lat: interpolatedLat_4, lng: interpolatedLng_4 });
        swallow5.setPosition({ lat: interpolatedLat_5, lng: interpolatedLng_5 });
        
    }

    //清
    if(currentValue >=8000 && currentValue <=9000){
        var points_6 = [initialCoords_swallow6,  newCoords_swallow6_1, newCoords_swallow6_1];
        var points_7 = [initialCoords_swallow7,  newCoords_swallow7_1, newCoords_swallow7_1];
   
    // 计算当前阶段的目标点的索引
        var targetIndex_6 = Math.floor((currentValue - 8000) / (1000 / (points_6.length-1)));
        var targetIndex_7 = Math.floor((currentValue - 8000) / (1000 / (points_7.length-1)));
        
    // 计算插值百分比
        var percentage_6 = (currentValue - 8000) % (1000 / (points_6.length-1)) / (1000 / (points_6.length-1));
        var percentage_7 = (currentValue - 8000) % (1000 / (points_7.length-1)) / (1000 / (points_7.length-1));
        
        
        percentage_6 = Math.min(1, Math.max(0, percentage_6));
        percentage_7 = Math.min(1, Math.max(0, percentage_7));
        
        
    // 计算插值的新位置
        var latDiff = points_6[targetIndex_6 + 1].lat - points_6[targetIndex_6].lat;
        var lngDiff = points_6[targetIndex_6 + 1].lng - points_6[targetIndex_6].lng;
        var interpolatedLat_6 = points_6[targetIndex_6].lat + latDiff * percentage_6;
        var interpolatedLng_6 = points_6[targetIndex_6].lng + lngDiff * percentage_6;

        var latDiff = points_7[targetIndex_7 + 1].lat - points_7[targetIndex_7].lat;
        var lngDiff = points_7[targetIndex_7 + 1].lng - points_7[targetIndex_7].lng;
        var interpolatedLat_7 = points_7[targetIndex_7].lat + latDiff * percentage_7;
        var interpolatedLng_7 = points_7[targetIndex_7].lng + lngDiff * percentage_7;

        
        
    // 设置swallow27的位置
        swallow6.setPosition({ lat: interpolatedLat_6, lng: interpolatedLng_6 });
        swallow7.setPosition({ lat: interpolatedLat_7, lng: interpolatedLng_7 });
        
        
    }
    
    
});










